<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Benchmark dose estimation from isotonic regression — bmdIsoBoot • bmd</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Benchmark dose estimation from isotonic regression — bmdIsoBoot"><meta property="og:description" content="The function estimates BMD and BMDL using bootstrap based on isotonic
regression."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-bmd-functions.html">basic-bmd-functions</a>
    </li>
    <li>
      <a href="../articles/bmd_Package.html">bmd Package</a>
    </li>
    <li>
      <a href="../articles/model-averaging.html">model-averaging</a>
    </li>
    <li>
      <a href="../articles/specialized-models.html">specialized-models</a>
    </li>
    <li>
      <a href="../articles/statistical-tests.html">statistical-tests</a>
    </li>
    <li>
      <a href="../articles/utilities.html">utilities</a>
    </li>
    <li>
      <a href="../articles/visualization.html">visualization</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Benchmark dose estimation from isotonic regression</h1>

    <div class="hidden name"><code>bmdIsoBoot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function estimates BMD and BMDL using bootstrap based on isotonic
regression.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bmdIsoBoot</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">bmr</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  boot <span class="op">=</span> <span class="st">"resample"</span>,</span>
<span>  backgType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modelBased"</span>, <span class="st">"absolute"</span>, <span class="st">"hybridSD"</span>, <span class="st">"hybridPercentile"</span><span class="op">)</span>,</span>
<span>  backg <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  def <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"excess"</span>, <span class="st">"additional"</span>, <span class="st">"relative"</span>, <span class="st">"added"</span>, <span class="st">"hybridExc"</span>, <span class="st">"hybridAdd"</span>, <span class="st">"point"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>an object of class "formula" expressing dose-response
relationship. Details of model specification are given under 'Details'</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data frame containing the variables in the model</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>character string specifying the type of data used in the model.
"continuous" or "binomial" or "Poisson"</p></dd>


<dt id="arg-bmr">bmr<a class="anchor" aria-label="anchor" href="#arg-bmr"></a></dt>
<dd><p>numeric value of benchmark response level for which to calculate
the benchmark dose</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>number of bootstrap samples</p></dd>


<dt id="arg-boot">boot<a class="anchor" aria-label="anchor" href="#arg-boot"></a></dt>
<dd><p>character string specifying type of bootstrap used. "resample"
or "pseudorandom". Only option for count data is "resample"</p></dd>


<dt id="arg-backgtype">backgType<a class="anchor" aria-label="anchor" href="#arg-backgtype"></a></dt>
<dd><p>character string specifying how the background level is
specified. For binomial data the options are "modelBased" and "absolute".
For continuous data the options are "modelBased", "absolute", "hybridSD" and
"hybridPercentile"</p>
<p>"modelBased" - the background level is obtained from the model as the level
for dose 0: p0 = f(0)</p>
<p>"absolute" - the background level is specified by the user through the backg
argument: p0 = backg for binomial response and for the "relative" and
"added" definition for continuous response.  p0 = 1 - phi((back -
f(0))/sigma) for "hybridExc" and "hybridAdd" definitions.</p>
<p>"hybridSD" - the background risk is specified by the user in terms of number
of SDs from the mean of the control group.  p0 = 1 - phi(((backg*sigma +
f(0)) - f(0))/sigma) = 1 - phi(backg), where phi is the normal distribution
function and sigma is the SD for the control group.  "hybridPercentile" -
the background risk is specified by the user in terms of percentile from the
control group distribution (assuming a normal distribution).  p0 = 1 -
phi((x0 - f(0))/sigma) = 1 - backg.  where x0 is the level for which the
response is considered adverse, phi is the normal distribution function and
sigma is the SD for the control group</p></dd>


<dt id="arg-backg">backg<a class="anchor" aria-label="anchor" href="#arg-backg"></a></dt>
<dd><p>numeric value specifying the background level. Defaults to 0
for "absolute" background risk for binomial response (1 for decreasing
dose-response models), 2 SD for "hybridSD" background and 0.9 for
"hybridpercentile"</p></dd>


<dt id="arg-def">def<a class="anchor" aria-label="anchor" href="#arg-def"></a></dt>
<dd><p>character string specifying the definition of the benchmark dose
to use in the calculations. "excess", "additional" and "point" are for
binomial response whereas "relative", "added", "hybridExc" (excess hybrid),
"hybridAdd" (additional hybrid), and "point" are for continuous response.
"relative", "extra", and "point" are for count response data.</p>
<p>"excess" - BMR is defined as: BMR = (f(BMD) - p0)/(1 - p0).  Works for
binomial response. BMR should be between 0 and 1.</p>
<p>"additional" - BMR is defined as: BMR = f(BMD) - p0.  Works for binomial
response. BMR should be between 0 and 1.</p>
<p>"point" - The response level for which to find BMD is directly defined
through the BMR level: BMR = f(BMD). Works for binomial, count and
continuous response</p>
<p>"relative" - BMR is defined as: BMR = (f(BMD) - p0)/p0.  Works for count and
continuous response</p>
<p>"added" - BMR is defined as: BMR= f(BMD) + p0.  Works for continuous
response</p>
<p>"hybridExc" - BMR is defined as: BMR = (1 - phi((x0 - f(BMD))/sigma) - p0)/
(1- p0), where x0 is the level for which the response is considered adverse,
phi is the normal distribution function and sigma is the SD for the control
group.  Works for continuous response</p>
<p>"hybridAdd" - BMR is defined as: BMR = 1 - phi((x0 - f(BMD))/sigma) - p0,
where x0 is the level for which the response is considered adverse, phi is
the normal distribution function and sigma is the SD for the control group.
Works for continuous response</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A matrix with two columns, one containing BMD and the other
containing BMDL.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>BMD and BMDL is defined as the median and the 5th percentile in the
bootstrap distribution, respectively.</p>
<p>Formula should be specified as in the form number/total ~ dose for binomial
data.</p>
<p>Bootstrapping with the argument boot = "resample" is done by sampling with
replacement from the original data set. Bootstrapping with the argument boot
= "pseudorandom" is done by sampling from norm(mean(Y_i),sd(Y_0)), assuming
equal variance between groups, in case of continuous data. For binomial
data, each bootstrap data set is sampled from binom(N_i,Y_i/N_i). In case of
Y_i = 0 or Y_i = N_i shrinkage is used to avoid that the resampling always
produces 0 or 1, respectively. In this case data is sampled from
binom(N_i,(Y_i+1/3)/(N_i+1/3)).</p>
<p>All sampling is made within dose groups.</p>
<p>For details about the use of isotonic regression for BMD estimation see
Piegorsch et al. (20014) and Lin et al. (2015).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Piegorsch, W. W., Xiong, H., Bhattacharya, R. N., &amp; Lin, L.
(2014). Benchmark dose analysis via nonparametric regression modeling. Risk
Analysis, 34(1), 135-151</p>
<p>Lin, L., Piegorsch, W. W. and Bhattacharya R. (2015). Nonparametric
benchmark dose estimation with continuous dose-response data. Scandinavian
Journal of Statistics, 42, 713-731</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Signe M. Jensen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Data on tumor incidence in rats after exposure to formaldehyde, from Piegorsch et al. (2014)</span></span></span>
<span class="r-in"><span><span class="va">formaldehyde</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>conc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.7</span>, <span class="fl">2.0</span>, <span class="fl">6.0</span>, <span class="fl">10.0</span>, <span class="fl">15.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          tumor.incidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">21</span>, <span class="fl">150</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">122</span>, <span class="fl">27</span>, <span class="fl">126</span>, <span class="fl">113</span>, <span class="fl">34</span>, <span class="fl">182</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                          </span></span>
<span class="r-in"><span><span class="co"># BMD and BMDL from isotonic regression using excess risk definition and a BMR=0.1</span></span></span>
<span class="r-in"><span><span class="fu">bmdIsoBoot</span><span class="op">(</span><span class="va">tumor.incidence</span><span class="op">/</span><span class="va">total</span> <span class="op">~</span> <span class="va">conc</span>, </span></span>
<span class="r-in"><span>      data<span class="op">=</span><span class="va">formaldehyde</span>, </span></span>
<span class="r-in"><span>      type<span class="op">=</span><span class="st">"binomial"</span>,</span></span>
<span class="r-in"><span>      bmr<span class="op">=</span><span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>      backgType <span class="op">=</span> <span class="st">"modelBased"</span>,</span></span>
<span class="r-in"><span>      def <span class="op">=</span> <span class="st">"excess"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      BMD     BMDL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6.49705 6.322712</span>
<span class="r-in"><span>      </span></span>
<span class="r-in"><span>      </span></span>
<span class="r-in"><span><span class="co">## Data on root length in ryegrass after exposure to ferulic acid</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org" class="external-link">drc</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ryegrass</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As isotonic regression only wors for increasing dose-response relationship</span></span></span>
<span class="r-in"><span><span class="co"># the association is turned</span></span></span>
<span class="r-in"><span><span class="va">ryegrass1</span><span class="op">&lt;-</span><span class="va">ryegrass</span></span></span>
<span class="r-in"><span><span class="va">ryegrass1</span><span class="op">$</span><span class="va">rootl</span><span class="op">&lt;-</span><span class="fl">100</span><span class="op">-</span><span class="va">ryegrass1</span><span class="op">$</span><span class="va">rootl</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimating BMD from isotonic regression using relative risk definition and a BMR=0.05</span></span></span>
<span class="r-in"><span><span class="fu">bmdIsoBoot</span><span class="op">(</span><span class="va">rootl</span> <span class="op">~</span> <span class="va">conc</span>, </span></span>
<span class="r-in"><span>      data<span class="op">=</span><span class="va">ryegrass1</span>, </span></span>
<span class="r-in"><span>      type<span class="op">=</span><span class="st">"continuous"</span>,</span></span>
<span class="r-in"><span>      bmr<span class="op">=</span><span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>      backgType <span class="op">=</span> <span class="st">"modelBased"</span>,</span></span>
<span class="r-in"><span>      def <span class="op">=</span> <span class="st">"relative"</span>, R <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       BMD     BMDL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3.682826 3.249387</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Signe M. Jensen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

