<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Benchmark dose estimation using bootstrap — bmdBoot • bmd</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Benchmark dose estimation using bootstrap — bmdBoot"><meta property="og:description" content="The function estimates BMD and BMDL using bootstrap based on parametric
dose-response models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-bmd-functions.html">basic-bmd-functions</a>
    </li>
    <li>
      <a href="../articles/bmd_Package.html">bmd Package</a>
    </li>
    <li>
      <a href="../articles/model-averaging.html">model-averaging</a>
    </li>
    <li>
      <a href="../articles/specialized-models.html">specialized-models</a>
    </li>
    <li>
      <a href="../articles/statistical-tests.html">statistical-tests</a>
    </li>
    <li>
      <a href="../articles/utilities.html">utilities</a>
    </li>
    <li>
      <a href="../articles/visualization.html">visualization</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Benchmark dose estimation using bootstrap</h1>

    <div class="hidden name"><code>bmdBoot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function estimates BMD and BMDL using bootstrap based on parametric
dose-response models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bmdBoot</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">bmr</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  bootType <span class="op">=</span> <span class="st">"nonparametric"</span>,</span>
<span>  bmdType <span class="op">=</span> <span class="st">"orig"</span>,</span>
<span>  backgType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modelBased"</span>, <span class="st">"absolute"</span>, <span class="st">"hybridSD"</span>, <span class="st">"hybridPercentile"</span><span class="op">)</span>,</span>
<span>  backg <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  controlSD <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  def <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"excess"</span>, <span class="st">"additional"</span>, <span class="st">"relative"</span>, <span class="st">"extra"</span>, <span class="st">"added"</span>, <span class="st">"hybridExc"</span>, <span class="st">"hybridAdd"</span>,</span>
<span>    <span class="st">"point"</span><span class="op">)</span>,</span>
<span>  respTrans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"log"</span>, <span class="st">"sqrt"</span><span class="op">)</span>,</span>
<span>  bootInterval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"percentile"</span>, <span class="st">"BCa"</span><span class="op">)</span>,</span>
<span>  display <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>object of class <code>drc</code></p></dd>


<dt id="arg-bmr">bmr<a class="anchor" aria-label="anchor" href="#arg-bmr"></a></dt>
<dd><p>numeric value of benchmark response level for which to calculate
the benchmark dose</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>number of bootstrap samples. Default is 1000</p></dd>


<dt id="arg-boottype">bootType<a class="anchor" aria-label="anchor" href="#arg-boottype"></a></dt>
<dd><p>character string specifying type of bootstrap used.
"nonparametric" (default), "semiparametric" or "parametric". "Semiparametric
is only available for continuous data and "nonparametric" is at present the
only option for count data. See details below</p></dd>


<dt id="arg-bmdtype">bmdType<a class="anchor" aria-label="anchor" href="#arg-bmdtype"></a></dt>
<dd><p>Type of estimate for BMD. Default is "orig" the bmd estimate
from the original data set. Other choices are "mean" - the mean of the
bootstrap estimates, or "median" - the median of the bootstrap estimates</p></dd>


<dt id="arg-backgtype">backgType<a class="anchor" aria-label="anchor" href="#arg-backgtype"></a></dt>
<dd><p>character string specifying how the background level is
specified. For binomial and count data the options are "modelBased" and
"absolute". For continuous data the options are "modelBased", "absolute",
"hybridSD" and "hybridPercentile"</p>
<p>"modelBased" - the background level is obtained from the model as the level
for dose 0: p0 = f(0)</p>
<p>"absolute" - the background level is specified by the user through the backg
argument: p0 = backg for binomial response and for the "relative", "extra"
and "added" definition for continuous response.  p0 = 1 - phi((back -
f(0))/sigma) for "hybridExc" and "hybridAdd" definitions.</p>
<p>"hybridSD" - the background risk is specified by the user in terms of number
of SDs from the mean of the control group.  p0 = 1 - phi(((backg*sigma +
f(0)) - f(0))/sigma) = 1 - phi(backg), where phi is the normal distribution
function and sigma is the SD for the control group.  "hybridPercentile" -
the background risk is specified by the user in terms of percentile from the
control group distribution (assuming a normal distribution).  p0 = 1 -
phi((x0 - f(0))/sigma) = 1 - backg.  where x0 is the level for which the
response is considered adverse, phi is the normal distribution function and
sigma is the SD for the control group</p></dd>


<dt id="arg-backg">backg<a class="anchor" aria-label="anchor" href="#arg-backg"></a></dt>
<dd><p>numeric value specifying the background level. Defaults to 0
for "absolute" background level for binomial response (1 for decreasing
dose-response models), 2 SD for "hybridSD" background and 0.9 for
"hybridpercentile"</p></dd>


<dt id="arg-controlsd">controlSD<a class="anchor" aria-label="anchor" href="#arg-controlsd"></a></dt>
<dd><p>numeric value specifying the standard deviation of the
control group (used in the hybrid approach). If not specified the SD for the
control group will be estimated as the square root of the residual variance
(assuming variance homogeneity).</p></dd>


<dt id="arg-def">def<a class="anchor" aria-label="anchor" href="#arg-def"></a></dt>
<dd><p>character string specifying the definition of the benchmark dose
to use in the calculations. "excess" , "additional" and "point" are for
binomial response whereas "relative", "extra", "added", "hybridExc" (excess
hybrid), "hybridAdd" (additional hybrid), and "point" are for continuous
response. "relative", "extra", and "point" are for count response data.</p>
<p>"excess" - BMR is defined as: BMR = (f(BMD) - p0)/(1 - p0).  Works for
binomial response. BMR should be between 0 and 1.</p>
<p>"additional" - BMR is defined as: BMR = f(BMD) - p0.  Works for binomial
response. BMR should be between 0 and 1.</p>
<p>"point" - The response level for which to find BMD is directly defined
through the BMR level: BMR = f(BMD). Works for binomial, count and
continuous response</p>
<p>"relative" - BMR is defined as: BMR = (f(BMD) - p0)/p0.  Works for count and
continuous response</p>
<p>"extra" - BMR is defined as: BMR = (f(BMD) - p0)/(f(Inf) - p0).  Works for
count and continuous response</p>
<p>"added" - BMR is defined as: BMR= f(BMD) + p0.  Works for count and
continuous response</p>
<p>"hybridExc" - BMR is defined as: BMR = (1 - phi((x0 - f(BMD))/sigma) - p0)/
(1- p0), where x0 is the level for which the response is considered adverse,
phi is the normal distribution function and sigma is the SD for the control
group.  Works for continuous response</p>
<p>"hybridAdd" - BMR is defined as: BMR = 1 - phi((x0 - f(BMD))/sigma) - p0,
where x0 is the level for which the response is considered adverse, phi is
the normal distribution function and sigma is the SD for the control group.
Works for continuous response</p></dd>


<dt id="arg-resptrans">respTrans<a class="anchor" aria-label="anchor" href="#arg-resptrans"></a></dt>
<dd><p>if the dose-response model is fitted with a transformed
response, specifying this option ensures that the background level for the
BMD is computed on the original scale.  Options include "none" (default),
"log" (natural logarithm) and "sqrt"(square root).</p></dd>


<dt id="arg-bootinterval">bootInterval<a class="anchor" aria-label="anchor" href="#arg-bootinterval"></a></dt>
<dd><p>character string indicating type of bootstrap interval
used for estimating BMDL. "Percentile" (default) or "BCa" (Bias corrected
and adjusted)</p></dd>


<dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>logical. If TRUE the results are displayed; otherwise they
are not</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>numeric value specifying the levle of the confidence interval
underlying BMDL. Default is 0.95</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of three elements: Results contain the estimated BMD and
BMDL, bootEst is a vector af all of the estimated BMD values from each
bootstrap sample, Interval gives BMDL and BMDU, which is identical to the
confidence interval for the percentile interval approach.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>BMDL is defined as the 5th percentile in the bootstrap distribution.</p>
<p>Bootstrapping with the argument boot = "nonparametric" is done by sampling
with replacement from the original data set. Bootstrapping with the argument
boot = "parametric" is done by sampling from norm(mean(Y_i),sd(Y_0)),
assuming equal variance between groups, in case of continuous data. For
binomial data, each bootstrap data set is sampled from binom(N_i,Y_i/N_i).
In case of Y_i = 0 or Y_i = N_i shrinkage is used to avoid that the
resampling always produces 0 or 1, respectively. In this case data is
sampled from binom(N_i,(Y_i+1/4)/(N_i+1/2)). Bootstrapping with argument
boot = "semiparametric" is done by sampling with replacement from the
residuals.</p>
<p>All sampling is made within dose groups.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Signe M. Jensen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Data on root length in ryegrass after exposure to ferulic acid</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org" class="external-link">drc</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org" class="external-link">drcData</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ryegrass</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ryegrass.m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">rootl</span> <span class="op">~</span> <span class="va">conc</span>, data <span class="op">=</span> <span class="va">ryegrass</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/LL.4.html" class="external-link">LL.4</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## BMD using the hybrid method, background risk is 2 SD, hybrid definition using excess risk</span></span></span>
<span class="r-in"><span><span class="fu">bmdBoot</span><span class="op">(</span><span class="va">ryegrass.m1</span>, <span class="fl">0.05</span>, backgType <span class="op">=</span> <span class="st">"hybridSD"</span>, def <span class="op">=</span> <span class="st">"hybridAdd"</span>, R <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       BMD      BMDL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.041279 0.8640942</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## BMD from the same definitions but using parametric bootstrap</span></span></span>
<span class="r-in"><span><span class="fu">bmdBoot</span><span class="op">(</span><span class="va">ryegrass.m1</span>, <span class="fl">0.05</span>, backgType <span class="op">=</span> <span class="st">"hybridSD"</span>, def <span class="op">=</span> <span class="st">"hybridAdd"</span>, bootType<span class="op">=</span><span class="st">"parametric"</span>,R <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       BMD      BMDL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.041279 0.7704424</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Signe M. Jensen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

