<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Benchmark dose estimation for ordinal dose-response models — bmdOrdinalMA • bmd</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Benchmark dose estimation for ordinal dose-response models — bmdOrdinalMA"><meta property="og:description" content="Estimation of benchmark doses and benchmark dose lower limit based on model
averaging from a user-defined list of ordinal dose-response model fits"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-bmd-functions.html">basic-bmd-functions</a>
    </li>
    <li>
      <a href="../articles/bmd_Package.html">bmd Package</a>
    </li>
    <li>
      <a href="../articles/model-averaging.html">model-averaging</a>
    </li>
    <li>
      <a href="../articles/specialized-models.html">specialized-models</a>
    </li>
    <li>
      <a href="../articles/statistical-tests.html">statistical-tests</a>
    </li>
    <li>
      <a href="../articles/utilities.html">utilities</a>
    </li>
    <li>
      <a href="../articles/visualization.html">visualization</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Benchmark dose estimation for ordinal dose-response models</h1>

    <div class="hidden name"><code>bmdOrdinalMA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimation of benchmark doses and benchmark dose lower limit based on model
averaging from a user-defined list of ordinal dose-response model fits</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bmdOrdinalMA</span><span class="op">(</span></span>
<span>  <span class="va">modelList</span>,</span>
<span>  modelWeights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>  <span class="va">bmr</span>,</span>
<span>  backgType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modelBased"</span>, <span class="st">"absolute"</span><span class="op">)</span>,</span>
<span>  backg <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  def <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"excess"</span>, <span class="st">"additional"</span>, <span class="st">"point"</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bootstrap"</span>, <span class="st">"Kang"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  bootType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nonparametric"</span>, <span class="st">"parametric"</span><span class="op">)</span>,</span>
<span>  display <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progressInfo <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-modellist">modelList<a class="anchor" aria-label="anchor" href="#arg-modellist"></a></dt>
<dd><p>A list of ordinal dose-response models of class
<code>drcOrdinal</code></p></dd>


<dt id="arg-modelweights">modelWeights<a class="anchor" aria-label="anchor" href="#arg-modelweights"></a></dt>
<dd><p>character string specifying the type of weights used,
"AIC" or "BIC", or a numeric vector of the same length as the modelList with
user defined weights</p></dd>


<dt id="arg-bmr">bmr<a class="anchor" aria-label="anchor" href="#arg-bmr"></a></dt>
<dd><p>numeric value of benchmark response level for which to calculate
the benchmark dose</p></dd>


<dt id="arg-backgtype">backgType<a class="anchor" aria-label="anchor" href="#arg-backgtype"></a></dt>
<dd><p>character string specifying how the background level is
specified. The options are "modelBased" and "absolute".</p>
<p>"modelBased" - the background level is obtained from the model as the level
for dose 0: p0 = f(0)</p>
<p>"absolute" - the background level is specified by the user through the backg
argument.</p></dd>


<dt id="arg-backg">backg<a class="anchor" aria-label="anchor" href="#arg-backg"></a></dt>
<dd><p>numeric value specifying the background level. Defaults to 0
for "absolute" background risk.</p></dd>


<dt id="arg-def">def<a class="anchor" aria-label="anchor" href="#arg-def"></a></dt>
<dd><p>character string specifying the definition of the benchmark dose
to use in the calculations. "excess", "additional" and "point" are available
for ordinal response.</p>
<p>"excess" - BMR is defined as: BMR = (f(BMD) - p0)/(1 - p0).  Works for
binomial response. BMR should be between 0 and 1.</p>
<p>"additional" - BMR is defined as: BMR = f(BMD) - p0.  Works for binomial
response. BMR should be between 0 and 1.</p>
<p>"point" - The response level for which to find BMD is directly defined
through the BMR level: BMR = f(BMD). Works for binomial, count and
continuous response data.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>specify the model averaging type used for the confidence
intervals. Options are "Kang" (confidence intervals computed as weighted
averages of individual confidence intervals) and "bootstrap"</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>numeric value specifying the levle of the confidence interval
underlying BMDL. Default is 0.95</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>integer specifying the number of data sets resampled from the
original data set when computing the confidence interval by bootstrap.</p></dd>


<dt id="arg-boottype">bootType<a class="anchor" aria-label="anchor" href="#arg-boottype"></a></dt>
<dd><p>character string specifying the resampling procedure for the
data sets used for bootstrap.</p>
<p>"nonparametric" - Bootstrapping is done by sampling with replacement from
the original data set.</p>
<p>"parametric" - Bootstrapping is done by sampling from a multinomial
distribution with probabilites given by the number of observations for each
level. If all observations for one group are in the same level, shrinkage is
used to avoid that the resampling always produces that particular level. In
this case data is sampled from a multinomial distribution with probabilities
(1/|K|^2)/(N_i + 1/|K|) for the levels with 0 observations, and (N_i +
1/|K|^2)/(N_i + 1/|K|), where N_i is the number of observatiions for the
particular group, and |K| is the number of levels.</p>
<p>All resampling is done within the dose values.</p></dd>


<dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>logical. If TRUE the results are displayed; otherwise they
are not</p></dd>


<dt id="arg-progressinfo">progressInfo<a class="anchor" aria-label="anchor" href="#arg-progressinfo"></a></dt>
<dd><p>logical. If TRUE, a progressbar is displayed when
calculating bootstrap confidence intervals</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of four elements: Results contain the estimated BMD and BMDL,
interval gives the lower (BMDL) and upper (BMDU) end of the confidence
interval of BMD.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The aim to provide an R package calculating the benchmark dose (BMD) and the
lower limit of the corresponding 95% confidence interval (BMDL) for
continuous, quantal, quantal and ordinal dose-response data for a range of
dose-response models based on the available definitions of the benchmark
dose concepts.</p>
<p>Details on the implemented definitions and methods can be found in Crump
(2002)</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Budtz-Jorgensen, E., Keiding, N., and Grandjean, P. (2001)
Benchmark Dose Calculation from Epidemiological Data, <em>Biometrics</em>
<b>57</b>, 698–706.</p>
<p>Crump, K. (2002) Critical Issues in Benchmark Calculations from Continuous
Data, <em>Critical Reviews in Toxicology</em> <b>32</b>, 133–153.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Signe M. Jensen and Jens Riis Baalkilde</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org" class="external-link">drc</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org" class="external-link">drcData</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">guthion</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">guthionS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">guthion</span>, <span class="va">trt</span> <span class="op">==</span> <span class="st">"S"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">guthionS.LL</span> <span class="op">&lt;-</span> <span class="fu"><a href="drmOrdinal.html">drmOrdinal</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alive"</span>, <span class="st">"moribund"</span>, <span class="st">"dead"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                          weights <span class="op">=</span> <span class="st">"total"</span>, dose <span class="op">=</span> <span class="st">"dose"</span>, data <span class="op">=</span> <span class="va">guthionS</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/LL.2.html" class="external-link">LL.2</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">guthionS.LN</span> <span class="op">&lt;-</span> <span class="fu"><a href="drmOrdinal.html">drmOrdinal</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alive"</span>, <span class="st">"moribund"</span>, <span class="st">"dead"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                          weights <span class="op">=</span> <span class="st">"total"</span>, dose <span class="op">=</span> <span class="st">"dose"</span>, data <span class="op">=</span> <span class="va">guthionS</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/lnormal.html" class="external-link">LN.2</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">guthionS.W1</span> <span class="op">&lt;-</span> <span class="fu"><a href="drmOrdinal.html">drmOrdinal</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alive"</span>, <span class="st">"moribund"</span>, <span class="st">"dead"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          weights <span class="op">=</span> <span class="st">"total"</span>, dose <span class="op">=</span> <span class="st">"dose"</span>, data <span class="op">=</span> <span class="va">guthionS</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/W2.html" class="external-link">W1.2</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">guthionS.W2</span> <span class="op">&lt;-</span> <span class="fu"><a href="drmOrdinal.html">drmOrdinal</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alive"</span>, <span class="st">"moribund"</span>, <span class="st">"dead"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          weights <span class="op">=</span> <span class="st">"total"</span>, dose <span class="op">=</span> <span class="st">"dose"</span>, data <span class="op">=</span> <span class="va">guthionS</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/W2.html" class="external-link">W2.2</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">bmdOrdinalMA</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">guthionS.LL</span>, <span class="va">guthionS.LN</span>, <span class="va">guthionS.W1</span>, <span class="va">guthionS.W2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             modelWeights <span class="op">=</span> <span class="st">"AIC"</span>, bmr <span class="op">=</span> <span class="fl">0.1</span>, </span></span>
<span class="r-in"><span>             backgType <span class="op">=</span> <span class="st">"modelBased"</span>, def <span class="op">=</span> <span class="st">"excess"</span>, type <span class="op">=</span> <span class="st">"Kang"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 BMD_MA  BMDL_MA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moribund+dead 20.20305 17.45350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dead          20.49732 17.26269</span>
<span class="r-in"><span><span class="fu">bmdOrdinalMA</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">guthionS.LL</span>, <span class="va">guthionS.LN</span>, <span class="va">guthionS.W1</span>, <span class="va">guthionS.W2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             modelWeights <span class="op">=</span> <span class="st">"AIC"</span>, bmr <span class="op">=</span> <span class="fl">0.1</span>, </span></span>
<span class="r-in"><span>             backgType <span class="op">=</span> <span class="st">"modelBased"</span>, def <span class="op">=</span> <span class="st">"excess"</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span>, R <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: reshape2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: tidyr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performing bootstrap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   8%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  72%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 BMD_MA  BMDL_MA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moribund+dead 20.20305 16.60024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dead          20.49732 16.32929</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Signe M. Jensen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

