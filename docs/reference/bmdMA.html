<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Model-averaged benchmark dose estimation — bmdMA • bmd</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Model-averaged benchmark dose estimation — bmdMA"><meta property="og:description" content="Estimation of benchmark doses and benchmark dose lower limit based on model
averaging from a user-defined list of dose response model fits"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-bmd-functions.html">basic-bmd-functions</a>
    </li>
    <li>
      <a href="../articles/bmd_Package.html">bmd Package</a>
    </li>
    <li>
      <a href="../articles/model-averaging.html">model-averaging</a>
    </li>
    <li>
      <a href="../articles/specialized-models.html">specialized-models</a>
    </li>
    <li>
      <a href="../articles/statistical-tests.html">statistical-tests</a>
    </li>
    <li>
      <a href="../articles/utilities.html">utilities</a>
    </li>
    <li>
      <a href="../articles/visualization.html">visualization</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Model-averaged benchmark dose estimation</h1>

    <div class="hidden name"><code>bmdMA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimation of benchmark doses and benchmark dose lower limit based on model
averaging from a user-defined list of dose response model fits</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bmdMA</span><span class="op">(</span></span>
<span>  <span class="va">modelList</span>,</span>
<span>  <span class="va">modelWeights</span>,</span>
<span>  <span class="va">bmr</span>,</span>
<span>  backgType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modelBased"</span>, <span class="st">"absolute"</span>, <span class="st">"hybridSD"</span>, <span class="st">"hybridPercentile"</span><span class="op">)</span>,</span>
<span>  backg <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  def <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"excess"</span>, <span class="st">"additional"</span>, <span class="st">"relative"</span>, <span class="st">"extra"</span>, <span class="st">"added"</span>, <span class="st">"hybridExc"</span>, <span class="st">"hybridAdd"</span>,</span>
<span>    <span class="st">"point"</span><span class="op">)</span>,</span>
<span>  respTrans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"log"</span>, <span class="st">"sqrt"</span><span class="op">)</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"sandwich"</span>, <span class="st">"inv"</span>, <span class="st">"profile"</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"curve"</span>, <span class="st">"bootstrap"</span>, <span class="st">"Kang"</span>, <span class="st">"Buckland"</span><span class="op">)</span>,</span>
<span>  bootstrapType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nonparametric"</span>, <span class="st">"parametric"</span><span class="op">)</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  bootInterval <span class="op">=</span> <span class="st">"percentile"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  stackingSeed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stackingSplits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  display <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progressInfo <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-modellist">modelList<a class="anchor" aria-label="anchor" href="#arg-modellist"></a></dt>
<dd><p>list of models of class <code>drc</code></p></dd>


<dt id="arg-modelweights">modelWeights<a class="anchor" aria-label="anchor" href="#arg-modelweights"></a></dt>
<dd><p>character string specifying the type of weights used,
"AIC", "BIC" or "Stack" (Baalkilde, J. R., Hansen, N. R., and Jensen, S. M.,
2025), or a vector of the same length as the modelList with user defined
weights</p></dd>


<dt id="arg-bmr">bmr<a class="anchor" aria-label="anchor" href="#arg-bmr"></a></dt>
<dd><p>numeric value of benchmark response level for which to calculate
the benchmark dose</p></dd>


<dt id="arg-backgtype">backgType<a class="anchor" aria-label="anchor" href="#arg-backgtype"></a></dt>
<dd><p>character string specifying how the background level is
specified. For binomial data the options are "modelBased" and "absolute".
For continuous data the options are "absolute", "hybridSD" and
"hybridPercentile"</p>
<p>"modelBased" - the background risk is obtained from the model as the risk
for dose 0: p0 = f(0)</p>
<p>"absolute" - the background risk is specified by the user through the backg
argument: p0 = backg for binomial response and for the "relative", "extra"
and "added" definition for continuous response.  p0 = 1 - phi((back -
f(0))/sigma) for "hybridExc" and "hybridAdd" definitions.</p>
<p>"hybridSD" - the background risk is specified by the user in terms of number
of SDs from the mean of the control group.  p0 = 1 - phi(((backg*sigma +
f(0)) - f(0))/sigma) = 1 - phi(backg), where phi is the normal distribution
function and sigma is the SD for the control group.  "hybridPercentile" -
the background risk is specified by the user in terms of percentile from the
control group distribution (assuming a normal distribution).  p0 = 1 -
phi((x0 - f(0))/sigma) = 1 - backg.  where x0 is the level for which the
response is considered adverse, phi is the normal distribution function and
sigma is the SD for the control group</p></dd>


<dt id="arg-backg">backg<a class="anchor" aria-label="anchor" href="#arg-backg"></a></dt>
<dd><p>numeric value specifying the background level. Defaults to 0
for "absolute" background risk for binomial response (1 for decreasing
dose-response models), 2 SD for "hybridSD" background and 0.9 for
"hybridpercentile"</p></dd>


<dt id="arg-def">def<a class="anchor" aria-label="anchor" href="#arg-def"></a></dt>
<dd><p>character string specifying the definition of the benchmark dose
to use in the calculations. "excess" , "additional" and "point" are for
binomial response whereas "relative", "extra", "added", "hybridExc" (excess
hybrid), "hybridAdd" (additional hybrid), and "point" are for continuous
response</p>
<p>"excess" - BMR is defined as: BMR = (f(BMD) - p0)/(1 - p0).  Works for
binomial response. BMR should be between 0 and 1.</p>
<p>"additional" - BMR is defined as: BMR = f(BMD) - p0.  Works for binomial
response. BMR should be between 0 and 1.</p>
<p>"point" - The response level for which to find BMD is directly defined
through the BMR level: BMR = f(BMD). Works for both binomial and continuous
response</p>
<p>"relative" - BMR is defined as: BMR = (f(BMD) - p0)/p0.  Works for
continuous response</p>
<p>"extra" - BMR is defined as: BMR = (f(BMD) - p0)/(f(Inf) - p0).  Works for
continuous response</p>
<p>"added" - BMR is defined as: BMR= f(BMD) + p0.  Works for continuous
response</p>
<p>"hybridExc" - BMR is defined as: BMR = (1 - phi((x0 - f(BMD))/sigma) - p0)/
(1- p0), where x0 is the level for which the response is considered adverse,
phi is the normal distribution function and sigma is the SD for the control
group.  Works for continuous response</p>
<p>"hybridAdd" - BMR is defined as: BMR = 1 - phi((x0 - f(BMD))/sigma) - p0,
where x0 is the level for which the response is considered adverse, phi is
the normal distribution function and sigma is the SD for the control group.
Works for continuous response</p></dd>


<dt id="arg-resptrans">respTrans<a class="anchor" aria-label="anchor" href="#arg-resptrans"></a></dt>
<dd><p>if the dose-response model is fitted with a transformed
response, specifying this option ensures that the background level for the
BMD is computed on the original scale.  Options include "none" (default),
"log" (natural logarithm) and "sqrt"(square root).</p></dd>


<dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p>character string specifying the type of confidence interval
to use for the individual models (no effect when type = "bootstrap" or
"curve"): "delta" (default), "sandwich", "inv" or "profile"</p>
<p>"delta" - BMDL is based on the lower limit of a Wald confidence interval
based on the delta method</p>
<p>"sandwich" - BMDL is based on the lower limit of a Wald confidence interval
based on the delta method where the sandwich covariance matrix is used</p>
<p>"inv" - BMDL is based on inverse regression, that is the dose associated
with the upper limit of the point wise confidence interval of the
dose-response curve. Not possible if type = "Buckland"</p>
<p>"profile" - BMDL is based on the lower limit of a profile likelihood
confidence interval. Not possible if type = "Buckland"</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>character string specifying how to estimate BMD and BMDL:
"curve", "bootstrap", "Kang" or "Buckland"</p>
<p>"curve" -</p>
<p>"bootstrap" -</p>
<p>"Kang" -</p>
<p>"Buckland" -</p></dd>


<dt id="arg-bootstraptype">bootstrapType<a class="anchor" aria-label="anchor" href="#arg-bootstraptype"></a></dt>
<dd><p>character string indicating type of bootstrap sampling
to be used if type="bootstrap" or "curve". "nonparametric" (default), or
"parametric" (see details)</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>number of bootstrap samples to use. Default is 1000</p></dd>


<dt id="arg-bootinterval">bootInterval<a class="anchor" aria-label="anchor" href="#arg-bootinterval"></a></dt>
<dd><p>character string indicating how to estimate the
bootstrap confidence intervals used to find BMDL type="bootstrap".
"percentile" (default) or "BCa" (Bias corrected and adjusted)</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>numeric value specifying the level of the confidence interval
underlying BMDL. Default is 0.95. Note that the full CI is also computed.
The full CI has level 1-2*(1-level)</p></dd>


<dt id="arg-stackingseed">stackingSeed<a class="anchor" aria-label="anchor" href="#arg-stackingseed"></a></dt>
<dd><p>integer or NULL: Random seed to use in the data split in
the estimation of the Stacking Weights when <code>modelWeights = "Stack"</code>.
The global seed is reset to the initial value after estimation of the
weights, so this option does not interfere with a globally set seed.</p></dd>


<dt id="arg-stackingsplits">stackingSplits<a class="anchor" aria-label="anchor" href="#arg-stackingsplits"></a></dt>
<dd><p>integer or "LOO": When <code>modelWeights = "Stack"</code>,
the Stacking Weights are estimated, which are based on V-fold
cross-validation. The stackingSplits argument sets the number V of data
splits used in the cross validation. The "LOO" (Leave one out) is a shortcut
to setting V equal to the number of observations in the data set.</p></dd>


<dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>logical. If TRUE the results are displayed; otherwise they
are not</p></dd>


<dt id="arg-progressinfo">progressInfo<a class="anchor" aria-label="anchor" href="#arg-progressinfo"></a></dt>
<dd><p>logical. If TRUE, a progressbar is shown when computing
bootstrap confidence intervals.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of five elements: Results contain the estimated BMD and BMDL,
Boot.samples.used gives the number of boot samples that resulted in
succesful estimations and were accordingly used in the estimation of BMDL
(and BMDU), Interval gives BMDL and BMDU, which is identical to the
confidence interval for the percentile interval approach, SE gives the
estimated SE for the "Buckland" method, and modelWeights includes the
estimated weights.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This package project is still under development. The aim to provide an R
package calculating the benchmark dose (BMD) and the lower limit of the
corresponding 95% confidence interval (BMDL) for continuous and quantal
dose-response data for a range of dose-response model based on the available
definitions of the benchmark dose concepts.</p>
<p>Details on the implemented definitions and methods can be found in Crump
(2002)</p>
<p>Bootstrapping with the argument boot = "nonparametric" is done by sampling
with replacement from the original data set. Bootstrapping with the argument
boot = "parametric" is done by sampling from norm(mean(Y_i),sd(Y_0)),
assuming equal variance between groups, in case of continuous data. For
binomial data, each bootstrap data set is sampled from binom(N_i,Y_i/N_i).
In case of Y_i = 0 or Y_i = N_i shrinkage is used to avoid that the
resampling always produces 0 or 1, respectively. In this case data is
sampled from binom(N_i,(Y_i+1/3)/(N_i+1/3)).</p>
<p>All sampling is made within dose groups.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Budtz-Jorgensen, E., Keiding, N., and Grandjean, P. (2001)
Benchmark Dose Calculation from Epidemiological Data, <em>Biometrics</em>
<b>57</b>, 698–706.</p>
<p>Crump, K. (2002) Critical Issues in Benchmark Calculations from Continuous
Data, <em>Critical Reviews in Toxicology</em> <b>32</b>, 133–153.</p>
<p>Baalkilde, J. R., Hansen, N. R., and Jensen, S. M. (2025) Stacking Weights
and Model Space Selection in Frequentist Model Averaging for Benchmark Dose
Estimation, <em>Environmetrics</em> <b>36(2)</b>, e70002.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Signe M. Jensen and Jens Riis Baalkilde</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org" class="external-link">drc</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org" class="external-link">drcData</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fitting 4 different two-parameter models to binomial data</span></span></span>
<span class="r-in"><span><span class="va">deguelin.m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">r</span><span class="op">/</span><span class="va">n</span><span class="op">~</span><span class="va">dose</span>, weights<span class="op">=</span><span class="va">n</span>, data<span class="op">=</span><span class="va">deguelin</span>, fct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/LL.2.html" class="external-link">LL.2</a></span><span class="op">(</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">deguelin.m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">r</span><span class="op">/</span><span class="va">n</span><span class="op">~</span><span class="va">dose</span>, weights<span class="op">=</span><span class="va">n</span>, data<span class="op">=</span><span class="va">deguelin</span>, fct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/W2.html" class="external-link">W1.2</a></span><span class="op">(</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">deguelin.m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">r</span><span class="op">/</span><span class="va">n</span><span class="op">~</span><span class="va">dose</span>, weights<span class="op">=</span><span class="va">n</span>, data<span class="op">=</span><span class="va">deguelin</span>, fct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/W2.html" class="external-link">W2.2</a></span><span class="op">(</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">deguelin.m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">r</span><span class="op">/</span><span class="va">n</span><span class="op">~</span><span class="va">dose</span>, weights<span class="op">=</span><span class="va">n</span>, data<span class="op">=</span><span class="va">deguelin</span>, fct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/lnormal.html" class="external-link">LN.2</a></span><span class="op">(</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model averaged BMD for 5% additional risk with estimated background risk </span></span></span>
<span class="r-in"><span><span class="co">## and BMDL based on Buckland et al.</span></span></span>
<span class="r-in"><span><span class="fu">bmdMA</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">deguelin.m1</span>,<span class="va">deguelin.m2</span>,<span class="va">deguelin.m3</span>,<span class="va">deguelin.m4</span><span class="op">)</span>, modelWeights<span class="op">=</span><span class="st">"AIC"</span>, <span class="fl">0.05</span>, </span></span>
<span class="r-in"><span>      backgType <span class="op">=</span> <span class="st">"modelBased"</span>, def <span class="op">=</span> <span class="st">"additional"</span>,</span></span>
<span class="r-in"><span>      type <span class="op">=</span> <span class="st">"Buckland"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    BMD_MA   BMDL_MA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.357897 0.5643594</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model averaged BMD for 5% additional risk with estimated background risk</span></span></span>
<span class="r-in"><span><span class="co">## and BMDL based on an average of the model curves</span></span></span>
<span class="r-in"><span><span class="fu">bmdMA</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">deguelin.m1</span>,<span class="va">deguelin.m2</span>,<span class="va">deguelin.m3</span>,<span class="va">deguelin.m4</span><span class="op">)</span>, modelWeights<span class="op">=</span><span class="st">"AIC"</span>, <span class="fl">0.05</span>, </span></span>
<span class="r-in"><span>      backgType <span class="op">=</span> <span class="st">"modelBased"</span>, def <span class="op">=</span> <span class="st">"additional"</span>,</span></span>
<span class="r-in"><span>      type <span class="op">=</span> <span class="st">"curve"</span>, bootstrapType <span class="op">=</span> <span class="st">"parametric"</span>, bootInterval <span class="op">=</span> <span class="st">"percentile"</span>, R<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performing bootstrap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   8%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  72%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    BMD_MA   BMDL_MA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.338646 0.5943252</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fitting 4 different two-parameter models to binomial data</span></span></span>
<span class="r-in"><span><span class="va">ryegrass.m1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">rootl</span><span class="op">~</span><span class="va">conc</span>, data<span class="op">=</span><span class="va">ryegrass</span>, fct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/LL.4.html" class="external-link">LL.4</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ryegrass.m2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">rootl</span><span class="op">~</span><span class="va">conc</span>, data<span class="op">=</span><span class="va">ryegrass</span>, fct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/W4.html" class="external-link">W1.4</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ryegrass.m3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">rootl</span><span class="op">~</span><span class="va">conc</span>, data<span class="op">=</span><span class="va">ryegrass</span>, fct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/W4.html" class="external-link">W2.4</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ryegrass.m4</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">rootl</span><span class="op">~</span><span class="va">conc</span>, data<span class="op">=</span><span class="va">ryegrass</span>, fct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/lnormal.html" class="external-link">LN.4</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model-averaged BMD and bootstrap BMDL for bmr=5% and using the hybrid approach</span></span></span>
<span class="r-in"><span><span class="co">## to estimate the background risk.  </span></span></span>
<span class="r-in"><span><span class="fu">bmdMA</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ryegrass.m1</span>,<span class="va">ryegrass.m2</span>,<span class="va">ryegrass.m3</span>,<span class="va">ryegrass.m4</span><span class="op">)</span>, modelWeights<span class="op">=</span><span class="st">"AIC"</span>, bmr<span class="op">=</span><span class="fl">0.05</span>, </span></span>
<span class="r-in"><span>      backgType <span class="op">=</span> <span class="st">"hybridSD"</span>, def <span class="op">=</span> <span class="st">"hybridAdd"</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span>,</span></span>
<span class="r-in"><span>      bootstrapType <span class="op">=</span> <span class="st">"nonparametric"</span>, bootInterval <span class="op">=</span> <span class="st">"percentile"</span>, R <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performing bootstrap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   8%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  72%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    BMD_MA   BMDL_MA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.179957 0.9312072</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model-averaged BMD using the Stacking Weights</span></span></span>
<span class="r-in"><span><span class="fu">bmdMA</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ryegrass.m1</span>,<span class="va">ryegrass.m2</span>,<span class="va">ryegrass.m3</span>,<span class="va">ryegrass.m4</span><span class="op">)</span>, modelWeights<span class="op">=</span><span class="st">"Stack"</span>, bmr<span class="op">=</span><span class="fl">0.05</span>, </span></span>
<span class="r-in"><span>      backgType <span class="op">=</span> <span class="st">"hybridSD"</span>, def <span class="op">=</span> <span class="st">"hybridAdd"</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span>,</span></span>
<span class="r-in"><span>      bootstrapType <span class="op">=</span> <span class="st">"nonparametric"</span>, bootInterval <span class="op">=</span> <span class="st">"percentile"</span>, R <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: CVXR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performing bootstrap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   8%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  72%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    BMD_MA   BMDL_MA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.313847 0.7801128</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Signe M. Jensen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

